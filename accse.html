<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GS4｜アクセサリー総覧（全キャラ共通）</title>
    <style>
        body {
            font-family: system-ui, "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
            margin: 0;
            background: #fff;
            color: #333
        }

        header {
            padding: 14px 16px;
            border-bottom: 1px solid #eee
        }

        h1 {
            font-size: 18px;
            margin: 0
        }

        .bar {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            padding: 10px 16px;
            border-bottom: 1px solid #eee
        }

        input,
        select,
        textarea {
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 10px
        }

        .wrap {
            padding: 10px 16px
        }

        table {
            width: 100%;
            border-collapse: collapse
        }

        th,
        td {
            border-bottom: 1px solid #eee;
            padding: 8px;
            text-align: left;
            font-size: 14px;
            vertical-align: top
        }

        .chip {
            display: inline-block;
            background: #f5f7f8;
            border-radius: 999px;
            padding: 2px 8px;
            font-size: 12px;
            margin-right: 6px
        }

        .small {
            font-size: 12px;
            color: #777
        }

        button {
            padding: 8px 10px;
            border: 1px solid #eee;
            border-radius: 10px;
            background: #fff;
            cursor: pointer
        }

        textarea {
            width: 100%;
            min-height: 120px
        }

        .src {
            margin-top: 8px
        }

        /* 色スウォッチ */
        .colorcell {
            display: flex;
            align-items: center;
            gap: 8px
        }

        .swatch {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 1px solid rgba(0, 0, 0, .1);
            background: var(--c, #ddd);
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, .6)
        }

        /* コンパクト行 */
        @media (max-width:640px) {

            th:nth-child(3),
            td:nth-child(3) {
                display: none
            }
        }

    </style>
</head>

<body>
    <header>
        <h1>アクセサリー総覧（全キャラ共通）</h1>
        <div class="small">フィルタで「属性／季節／アクセ種別」を絞り込み。URLパラメータで外部リンク連携OK（例：?attr=セクシー&type=ネックレス）。</div>
    </header>

    <div class="bar">
        <input id="q" type="search" placeholder="例：セクシー, ネックレス, 手袋, アクアブルー, 冬" style="flex:1">
        <select id="attr">
            <option value="">属性</option>
            <option>セクシー</option>
            <option>ビビッド</option>
            <option>シック</option>
            <option>ナチュラル</option>
            <option>アクティブ</option>
            <option>キュート</option>
        </select>
        <select id="shop">
            <option value="">ショップ</option>
            <option>アクセサリー・ミミ</option>
            <option>ジュエリー・マリア</option>
        </select>
        <select id="type">
            <option value="">アクセ種別</option>
            <option>ヘアアクセ</option>
            <option>眼鏡</option>
            <option>ピアス</option>
            <option>ネックレス</option>
            <option>ブレスレット</option>
            <option>バングル</option>
            <option>ストール</option>
            <option>ショール</option>
            <option>手袋</option>
            <option>コサージュ</option>
        </select>
        <button id="btnCopy">表示中をコピー</button>
    </div>

    <div class="wrap">
        <details>
            <summary>CSV貼り付けで一括追加</summary>
            <p class="small">列：ショップ,種別(ネックレス/手袋/バングル…),商品名,色,属性(複数は「/」),季節(任意),メモ（販売期間など）</p>
            <textarea id="csv"></textarea>
            <button id="import">取り込む</button>
        </details>

        <table id="tbl">
            <thead>
                <tr>
                    <th style="width:16%">ショップ</th>
                    <th style="width:14%">種別</th>
                    <th style="width:22%">商品名</th>
                    <th style="width:14%">色</th>
                    <th style="width:16%">属性</th>
                    <th style="width:8%">季節</th>
                    <th>メモ</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <div class="src small">
            備考：属性は“寄せ指標”として運用。必要に応じて追記/修正してください。データ構造は <code>mikage-shop.html</code> と互換。外部からは <code>accse.html?attr=セクシー&type=ネックレス</code> のようにリンク可能。
        </div>
    </div>

    <script>
        // ====== 初期データ（サンプル：ミミ／マリア中心。必要に応じて追加してください） ======
        const items = [
            // アクセサリー・ミミ
            {
                shop: "アクセサリー・ミミ",
                type: "ヘアアクセ",
                name: "コサージュヘアゴム",
                color: "ピンク",
                attrs: ["キュート"],
                season: "通年",
                memo: "2年2/1〜3年10/31"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "ヘアアクセ",
                name: "シュシュ",
                color: "レッド",
                attrs: ["ビビッド"],
                season: "2年4〜3年6",
                memo: "色でビビッド寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "ヘアアクセ",
                name: "バレッタ",
                color: "パープル",
                attrs: ["セクシー"],
                season: "1年2〜2年10",
                memo: "SE寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "眼鏡",
                name: "紫ふち眼鏡",
                color: "パープル",
                attrs: ["ビビッド"],
                season: "2年1〜3年12",
                memo: "VI寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "眼鏡",
                name: "黒ふち眼鏡",
                color: "ブラック",
                attrs: ["ナチュラル"],
                season: "1年6〜1年12",
                memo: "NA寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "ピアス",
                name: "バタフライピアス",
                color: "イエロー",
                attrs: ["セクシー"],
                season: "1年6〜1年12",
                memo: "SE寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "ネックレス",
                name: "スターネックレス",
                color: "イエロー",
                attrs: ["ビビッド"],
                season: "1年7〜1年3",
                memo: "VI寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "ブレスレット",
                name: "天然石ブレスレット",
                color: "ブルー",
                attrs: ["ナチュラル"],
                season: "1年6〜1年11",
                memo: "NA寄せ"
            },
            {
                shop: "アクセサリー・ミミ",
                type: "バングル",
                name: "ウッドバングル",
                color: "ブラウン",
                attrs: ["シック"],
                season: "3年7〜3年3",
                memo: "CH寄せ"
            },

            // ジュエリー・マリア
            {
                shop: "ジュエリー・マリア",
                type: "コサージュ",
                name: "コサージュ",
                color: "アクアブルー",
                attrs: ["ナチュラル"],
                season: "2年11〜3年6",
                memo: "NA寄せ"
            },
            {
                shop: "ジュエリー・マリア",
                type: "コサージュ",
                name: "コサージュ",
                color: "ブラウン",
                attrs: ["シック"],
                season: "2年2〜3年7",
                memo: "CH寄せ"
            },
            {
                shop: "ジュエリー・マリア",
                type: "ピアス",
                name: "フープピアス・パール",
                color: "ホワイト",
                attrs: ["シック"],
                season: "3年10〜3年2",
                memo: "CH寄せ"
            },
            {
                shop: "ジュエリー・マリア",
                type: "ネックレス",
                name: "ゴールドメダイネックレス",
                color: "イエロー",
                attrs: ["セクシー"],
                season: "2年1〜3年7",
                memo: "SE寄せ—御影◎系に好相性"
            },
            {
                shop: "ジュエリー・マリア",
                type: "ネックレス",
                name: "ターコイズのネックレス",
                color: "アクアブルー",
                attrs: ["シック"],
                season: "3年7〜3年2",
                memo: "CH寄せ"
            },
            {
                shop: "ジュエリー・マリア",
                type: "ストール",
                name: "チェック柄ストール",
                color: "レッド",
                attrs: ["ビビッド"],
                season: "2年9〜2年2",
                memo: "WARM10"
            },
            {
                shop: "ジュエリー・マリア",
                type: "ショール",
                name: "パーティーショール",
                color: "ホワイト",
                attrs: ["シック"],
                season: "2年12〜3年12",
                memo: "CH寄せ／WARM10"
            },
            {
                shop: "ジュエリー・マリア",
                type: "手袋",
                name: "フォーマルグローブ",
                color: "ピンク",
                attrs: ["キュート"],
                season: "2年9〜2年2",
                memo: "CU寄せ"
            },
            {
                shop: "ジュエリー・マリア",
                type: "手袋",
                name: "フォーマルグローブ",
                color: "アクアブルー",
                attrs: ["アクティブ"],
                season: "2年3〜3年8",
                memo: "AC寄せ"
            }
        ];

        // ====== 色名→HEX 推定 ======
        const colorMap = new Map(Object.entries({
            "ブラック": "#000000",
            "黒": "#000000",
            "black": "#000000",
            "ホワイト": "#ffffff",
            "白": "#ffffff",
            "white": "#ffffff",
            "レッド": "#e53935",
            "赤": "#e53935",
            "red": "#e53935",
            "ピンク": "#e91e63",
            "pink": "#e91e63",
            "パープル": "#7e57c2",
            "紫": "#7e57c2",
            "purple": "#7e57c2",
            "ブルー": "#2196f3",
            "青": "#2196f3",
            "blue": "#2196f3",
            "アクアブルー": "#26c6da",
            "ターコイズ": "#26c6da",
            "aqua": "#26c6da",
            "スカイブルー": "#29b6f6",
            "イエロー": "#fbc02d",
            "黄": "#fbc02d",
            "yellow": "#fbc02d",
            "オレンジ": "#fb8c00",
            "orange": "#fb8c00",
            "グリーン": "#43a047",
            "緑": "#43a047",
            "green": "#43a047",
            "ブラウン": "#795548",
            "茶": "#795548",
            "brown": "#795548",
            "グレー": "#9e9e9e",
            "灰": "#9e9e9e",
            "gray": "#9e9e9e",
            "grey": "#9e9e9e",
            "シルバー": "#c0c0c0",
            "ゴールド": "#d4af37"
        }));

        function guessHex(name) {
            if (!name) return null;
            const n = String(name).trim();
            if (colorMap.has(n)) return colorMap.get(n);
            for (const [k, v] of colorMap)
                if (n.includes(k)) return v;
            const m = n.match(/#([0-9a-f]{6})/i);
            return m ? "#" + m[1] : null;
        }

        // ====== UIレンダリング ======
        const elQ = document.getElementById('q');
        const elAttr = document.getElementById('attr');
        const elShop = document.getElementById('shop');
        const elType = document.getElementById('type');
        const tbody = document.querySelector('#tbl tbody');

        function render() {
            const term = elQ.value.trim().toLowerCase();
            const attr = elAttr.value;
            const shop = elShop.value;
            const type = elType.value;
            const shown = [];
            tbody.innerHTML = '';
            items.forEach(it => {
                const text = JSON.stringify(it).toLowerCase();
                const match = (!term || text.includes(term)) &&
                    (!attr || (it.attrs || []).includes(attr)) &&
                    (!shop || it.shop === shop) &&
                    (!type || it.type === type);
                if (!match) return;
                shown.push(it);
                const hex = guessHex(it.color);
                const tr = document.createElement('tr');
                tr.innerHTML = `
      <td>${it.shop}</td>
      <td>${it.type}</td>
      <td>${it.name}</td>
      <td><div class="colorcell"><span class="swatch" style="--c:${hex?hex:'#ddd'}" title="${it.color}${hex?` (${hex})`:''}"></span><span>${it.color||''}</span></div></td>
      <td>${(it.attrs||[]).map(a=>`<span class="chip">${a}</span>`).join('')}</td>
      <td>${it.season||''}</td>
      <td>${it.memo||''}</td>`;
                tbody.appendChild(tr);
            });
            document.getElementById('btnCopy').onclick = () => copyRows(shown);
            syncURL(); // フィルタ→URL反映
        }

        function copyRows(list) {
            const txt = list.map(it => [it.shop, it.type, it.name, it.color, (it.attrs || []).join('/'), it.season || '', it.memo || ''].join('\t')).join('\n');
            navigator.clipboard.writeText(txt);
        }
        elQ.oninput = render;
        elAttr.onchange = render;
        elShop.onchange = render;
        elType.onchange = render;

        // ====== CSV取り込み ======
        document.getElementById('import').onclick = () => {
            const csv = document.getElementById('csv').value.trim();
            if (!csv) return;
            csv.split(/\r?\n/).forEach(line => {
                const [shop, type, name, color, attrs, season, memo] = line.split(',');
                items.push({
                    shop: (shop || '').trim(),
                    type: (type || '').trim(),
                    name: (name || '').trim(),
                    color: (color || '').trim(),
                    attrs: (attrs || '').split('/').map(s => s.trim()).filter(Boolean),
                    season: (season || '').trim(),
                    memo: (memo || '').trim()
                });
            });
            render();
        };

        // ====== URLパラメータ ⇄ フィルタ連携 ======
        function applyParams() {
            const p = new URLSearchParams(location.search);
            if (p.has('attr')) setSel(elAttr, p.get('attr'));
            if (p.has('shop')) setSel(elShop, p.get('shop'));
            if (p.has('type')) setSel(elType, p.get('type'));
            if (p.has('q')) elQ.value = p.get('q');
        }

        function setSel(sel, val) {
            [...sel.options].forEach(o => {
                if (o.value === val) sel.value = val;
            });
        }

        function syncURL() {
            const p = new URLSearchParams();
            if (elAttr.value) p.set('attr', elAttr.value);
            if (elShop.value) p.set('shop', elShop.value);
            if (elType.value) p.set('type', elType.value);
            if (elQ.value.trim()) p.set('q', elQ.value.trim());
            const qs = p.toString();
            history.replaceState(null, '', qs ? ('?' + qs) : location.pathname);
        }

        applyParams();
        render();

    </script>
</body>

</html>
